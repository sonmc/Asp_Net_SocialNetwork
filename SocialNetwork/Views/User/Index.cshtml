
@model IEnumerable<SocialNetwork.Entities.New>
@using SocialNetwork.Constant;
@{
    ViewBag.Title = "Index";
    Layout = null;
}
<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Social Network</title>
    <meta name="robots" content="noindex, follow" />
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" type="image/x-icon" href="">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900" rel="stylesheet">
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/bicon.min.css" rel="stylesheet" />
    <link href="~/Content/flaticon.css" rel="stylesheet" />
    <link href="~/Content/plyr.css" rel="stylesheet" />
    <link href="~/Content/slick.min.css" rel="stylesheet" />
    <link href="~/Content/nice-select.css" rel="stylesheet" />
    <link href="~/Content/perfect-scrollbar.css" rel="stylesheet" />
    <link href="~/Content/lightgallery.min.css" rel="stylesheet" />
    <link href="~/Content/toast.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/Content/style.css">
</head>
<body>
    <header>
        <div class="header-top sticky bg-white d-none d-lg-block">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-md-10">
                        <div class="header-top-navigation">
                            <nav>
                                <ul>
                                    <li class="active"><a href="@Url.Action("Index", "User")">Social Network</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="header-top-right d-flex align-items-center justify-content-end">
                            <div class="profile-setting-box">
                                <div class="profile-thumb-small">
                                    <a href="javascript:void(0)" class="profile-triger">
                                        <figure>
                                            @if (ViewBag.CurrentUser.Avatar != "")
                                            {
                                                <img src="@ViewBag.CurrentUser.Avatar" alt="profile picture">
                                            }
                                            else
                                            {
                                                <img src="~/imgs/avatar_default.png" />
                                            }
                                        </figure>
                                    </a>
                                    <div class="profile-dropdown">
                                        <div class="profile-head">
                                            <h5 class="name"><a href="#">@ViewBag.CurrentUser.FirstName @ViewBag.CurrentUser.LastName</a></h5>
                                            <a class="mail" href="#">@ViewBag.CurrentUser.Email</a>
                                            <input hidden id="currentUserId" value="@ViewBag.CurrentUser.Id" />
                                        </div>
                                        <div class="profile-body">
                                            <ul>
                                                <li><a href="profile.html"><i class="flaticon-user"></i>Profile</a></li>
                                            </ul>
                                            <ul>
                                                <li><a href="@Url.Action("Logout", "User")"><i class="flaticon-unlock"></i>Signout</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <header>
        <div class="mobile-header-wrapper sticky d-block d-lg-none">
            <div class="mobile-header position-relative ">
                <div class="mobile-logo">
                    <a href="/" class="mobile-logo-text">
                        Social Network
                    </a>
                </div>

                <div class="mobile-header-profile">
                    <div class="profile-thumb profile-setting-box">
                        <a href="javascript:void(0)" class="profile-triger">
                            <figure class="profile-thumb-middle">
                                <img src="assets/images/profile/profile-small-1.jpg" alt="profile picture">
                            </figure>
                        </a>
                        <div class="profile-dropdown text-left">
                            <div class="profile-head">
                                <h5 class="name"><a href="#">Madison Howard</a></h5>
                                <a class="mail" href="#">mailnam@mail.com</a>
                            </div>
                            <div class="profile-body">
                                <ul>
                                    <li><a href="profile.html"><i class="flaticon-user"></i>Profile</a></li>
                                    <li><a href="#"><i class="flaticon-message"></i>Inbox</a></li>
                                    <li><a href="#"><i class="flaticon-document"></i>Activity</a></li>
                                </ul>
                                <ul>
                                    <li><a href="#"><i class="flaticon-settings"></i>Setting</a></li>
                                    <li><a href="signup.html"><i class="flaticon-unlock"></i>Sing out</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <main>
        <div class="main-wrapper pt-80">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-3 order-2 order-lg-1">
                        <aside class="widget-area">
                            <div class="card card-profile widget-item p-0">
                                <div class="profile-banner">
                                    <figure class="profile-banner-small">
                                        <a href="profile.html">
                                            <img class="sm-background" src="https://salt.tikicdn.com/ts/tmp/9a/7e/db/bd7f0652d2a0a04f5f557e75048291b5.jpg" alt="background">
                                        </a>
                                        <a href="profile.html" class="profile-thumb-2">
                                            <img src="@ViewBag.CurrentUser.Avatar" alt="Current avatar">
                                        </a>
                                    </figure>
                                    <div class="profile-desc text-center">
                                        <h6 class="author"><a href="profile.html">@ViewBag.CurrentUser.FirstName @ViewBag.CurrentUser.LastName</a></h6>
                                        <p>@ViewBag.CurrentUser.Description</p>
                                    </div>
                                </div>
                            </div>
                            <div class="card widget-item">
                                <h4 class="widget-title">Categories</h4>
                                <div class="widget-body">
                                    <ul class="like-page-list-wrapper">
                                        @foreach (var item in ViewBag.Categories)
                                        {
                                            <li class="unorder-list">
                                                <div class="unorder-list-info">
                                                    <h3 class="list-title"><a href="@Url.Action("Index", "User",new { categoryId = item.Id})">@item.Name</a></h3>
                                                </div>
                                            </li>

                                        }
                                    </ul>
                                </div>
                            </div>
                            <div class="card widget-item">
                                <h4 class="widget-title">Recent Notifications</h4>
                                <div class="widget-body">
                                    <ul class="like-page-list-wrapper">

                                        @foreach (var item in ViewBag.SharePosts)
                                        {
                                            <li class="unorder-list">
                                                <div class="profile-thumb">
                                                    <a href="#">
                                                        <figure class="profile-thumb-small">
                                                            <img src="@item.UserShared.Avatar" alt="profile picture">
                                                        </figure>
                                                    </a>
                                                </div>

                                                <div class="unorder-list-info">
                                                    <h3 class="list-title"><a href="javascript:;" onclick="openContentPostDetail(@item.NewId)">@item.UserShared.FirstName @item.UserShared.LastName Shared with you a content.</a></h3>
                                                    <p class="list-subtitle">@item.Time</p>
                                                </div>
                                            </li>
                                        }
                                    </ul>
                                </div>
                            </div>
                        </aside>

                    </div>

                    <div class="col-lg-6 order-1 order-lg-2" id="content-page">
                        <div class="card card-small">
                            <div class="share-box-inner">
                                <div class="profile-thumb">
                                    <a href="#">
                                        <figure class="profile-thumb-middle">
                                            <img src="@ViewBag.CurrentUser.Avatar" alt="Avatar">
                                        </figure>
                                    </a>
                                </div>
                                <div class="share-content-box w-100">
                                    <form class="share-text-box">
                                        <textarea name="share" class="share-text-field" aria-disabled="true" placeholder="Say Something" data-toggle="modal" data-target="#textbox" id="email"></textarea>
                                    </form>
                                </div>
                            </div>
                        </div>
                        @foreach (var item in Model)
                        {
                            <div class="card">
                                <div class="post-title d-flex align-items-center">
                                    <div class="profile-thumb">
                                        <figure class="profile-thumb-middle">
                                            <img src="@item.User.Avatar" alt="profile picture">
                                        </figure>
                                    </div>

                                    <div class="posted-author">
                                        <h6 class="author"><a href="profile.html">@item.User.FirstName @item.User.LastName</a></h6>
                                        <span class="post-time">@item.Time</span>
                                    </div>

                                    <div class="post-settings-bar">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                        <div class="post-settings arrow-shape">
                                            <ul>
                                                <li><a href="@Url.Action("UpdateNew","User", new { id = @item.Id })">Edit</a></li>
                                                <li><a href="@Url.Action("DeleteNew","User", new { id = @item.Id })">Delete</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="post-content">
                                    <p class="post-desc" id="content">
                                        @item.Content
                                    </p>
                                    @if (item.ContentType == Common.IMAGE_TYPE)
                                    {
                                        <div class="post-thumb-gallery post-thumb">
                                            <img src="@Url.Content("~/UploadedFiles/" + item.Image)" class="img-posted" alt="post image" />
                                        </div>
                                    }
                                    <div class="post-meta">
                                        <ul class="comment-share-meta">
                                            <li>
                                                <button onclick="openModalShare(@item.Id)" class="post-share">
                                                    <i class="bi bi-share"> </i>
                                                </button>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>

                    <div class="col-lg-3 order-3">
                        <aside class="widget-area">
                            <div class="card widget-item">
                                <h5 class="widget-title">Friend requests</h5>
                                <div class="widget-body">
                                    <ul class="like-page-list-wrapper">
                                        @foreach (var item in @ViewBag.FriendRequest)
                                        {
                                            <li class="unorder-list">
                                                <div class="profile-thumb">
                                                    <a href="#">
                                                        @if (@item.Avatar != null)
                                                        {
                                                            <figure class="profile-thumb-small">
                                                                <img src="@item.Avatar" alt="profile picture">
                                                            </figure>
                                                        }
                                                        else
                                                        {
                                                            <figure class="profile-thumb-small">
                                                                <img src="~/imgs/avatar_default.png" />
                                                            </figure>
                                                        }
                                                    </a>
                                                </div>

                                                <div class="unorder-list-info">
                                                    <h3 class="list-title"><a href="#">@item.FirstName @item.LastName </a> Sent you a friend request</h3>
                                                    <p class="list-subtitle">
                                                        <input hidden id="friendId" value="@item.Id" />
                                                        <a onclick="acceptFriend()" style="padding-right: 10px" class="">Accept</a>
                                                        <a onclick="removeFriend()" class="">Remove</a>
                                                    </p>
                                                </div>
                                                <button class="like-button">
                                                    <img class="heart" src="assets/images/icons/heart.png" alt="">
                                                    <img class="heart-color" src="assets/images/icons/heart-color.png" alt="">
                                                </button>
                                            </li>
                                        }
                                    </ul>
                                </div>
                            </div>
                            <div class="card widget-item">
                                <h5 class="widget-title">Do you know ?</h5>
                                <div class="widget-body">
                                    <ul class="like-page-list-wrapper">
                                        @foreach (var item in @ViewBag.FriendAround)
                                        {
                                            <li class="unorder-list">
                                                <div class="profile-thumb">
                                                    <a href="#">
                                                        @if (@item.Avatar != null)
                                                        {
                                                            <figure class="profile-thumb-small">
                                                                <img src="@item.Avatar" alt="profile picture">
                                                            </figure>
                                                        }
                                                        else
                                                        {
                                                            <figure class="profile-thumb-small">
                                                                <img src="~/imgs/avatar_default.png" />
                                                            </figure>
                                                        }
                                                    </a>
                                                </div>

                                                <div class="unorder-list-info">
                                                    <h3 class="list-title"><a href="#">@item.FirstName @item.LastName</a></h3>
                                                </div>
                                                <input hidden id="userId" value="@item.Id" />
                                                <button class="like-button" id="add-friend-path" onclick="addFriend()">
                                                    <img src="~/imgs/heart-color.png" />
                                                </button>
                                            </li>
                                        }
                                    </ul>
                                </div>
                            </div>
                            <div class="card widget-item">
                                <h5 class="widget-title">List friends</h5>
                                <div class="friend-search-list show">
                                    <div class="frnd-search-title">
                                        <input class="live-chat-field custom-scroll" placeholder="Tìm bạn" />
                                    </div>
                                    <div class="frnd-search-inner custom-scroll">
                                        <ul>
                                            @foreach (var item in ViewBag.Friends)
                                            {
                                                <li class="d-flex align-items-center profile-active">
                                                    <div class="profile-thumb active">
                                                        @if (@item.UserFriend.Avatar != null)
                                                        {
                                                            <figure class="profile-thumb-small">
                                                                <img src="@item.UserFriend.Avatar" alt="Friend Avatar">
                                                            </figure>
                                                        }
                                                        else
                                                        {
                                                            <figure class="profile-thumb-small">
                                                                <img src="~/imgs/avatar_default.png" />
                                                            </figure>
                                                        }
                                                    </div>

                                                    <div class="posted-author">
                                                        <h6 class="author">@item.UserFriend.FirstName @item.UserFriend.LastName</h6>
                                                    </div>
                                                </li>
                                            }
                                        </ul>
                                    </div>

                                </div>
                            </div>
                        </aside>
                    </div>

                </div>
            </div>
        </div>
    </main>
    <div class="scroll-top not-visible">
        <i class="bi bi-finger-index"></i>
    </div>
    <footer class="d-none d-lg-block">
        <div class="footer-area reveal-footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-3 offset-9">
                        <div class="footer-wrapper">
                            <div class="footer-card position-relative">
                                <div class="live-chat-inner">

                                    <div class="chat-output-box">
                                        <div class="live-chat-title">
                                            <div class="profile-thumb active">
                                                <a href="#">
                                                    <figure class="profile-thumb-small">
                                                        <img src="assets/images/profile/profile-small-15.jpg" alt="profile picture">
                                                    </figure>
                                                </a>
                                            </div>
                                            <div class="posted-author">
                                                <h6 class="author"><a href="profile.html">Robart Marloyan</a></h6>
                                                <span class="active-pro">active now</span>
                                            </div>
                                            <div class="live-chat-settings ml-auto">
                                                <button class="chat-settings"><i class="flaticon-settings"></i></button>
                                                <button class="close-btn" data-close="chat-output-box"><i class="flaticon-cross-out"></i></button>
                                            </div>
                                        </div>
                                        <div class="message-list-inner">
                                            <ul class="message-list custom-scroll">
                                                <li class="text-friends">
                                                    <p>Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text</p>
                                                    <div class="message-time">10 minute ago</div>
                                                </li>
                                                <li class="text-author">
                                                    <p>Many desktop publishing packages and web page editors</p>
                                                    <div class="message-time">5 minute ago</div>
                                                </li>
                                                <li class="text-friends">
                                                    <p>packages and web page editors </p>
                                                    <div class="message-time">2 minute ago</div>
                                                </li>
                                                <li class="text-friends">
                                                    <p>Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text</p>
                                                    <div class="message-time">10 minute ago</div>
                                                </li>
                                                <li class="text-author">
                                                    <p>Many desktop publishing packages and web page editors</p>
                                                    <div class="message-time">5 minute ago</div>
                                                </li>
                                                <li class="text-friends">
                                                    <p>packages and web page editors </p>
                                                    <div class="message-time">2 minute ago</div>
                                                </li>
                                            </ul>
                                            <div class="chat-text-field">
                                                <textarea class="live-chat-field custom-scroll" placeholder="Text Message"></textarea>
                                                <button class="chat-message-send" type="submit" value="submit">
                                                    <img src="assets/images/icons/plane.png" alt="">
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <footer class="d-block d-lg-none">
        <div class="footer-area reveal-footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="mobile-footer-inner d-flex">
                            <div class="mobile-frnd-search">
                                <button class="search-toggle-btn"><i class="flaticon-search"></i></button>
                            </div>
                            <div class="mob-frnd-search-inner">
                                <form class="mob-frnd-search-box d-flex">
                                    <input type="text" placeholder="Search Your Friends" class="mob-frnd-search-field">
                                </form>
                            </div>
                            <div class="card card-small mb-0 active-profile-mob-wrapper">
                                <div class="active-profiles-mob-wrapper slick-row-10">
                                    <div class="active-profile-mobile">
                                        <div class="single-slide">
                                            <div class="profile-thumb active profile-active">
                                                <a href="#">
                                                    <figure class="profile-thumb-small profile-active">
                                                        <img src="assets/images/profile/profile-small-1.jpg" alt="profile picture">
                                                    </figure>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="single-slide">
                                            <div class="profile-thumb active profile-active">
                                                <a href="javascript:void(0)">
                                                    <figure class="profile-thumb-small profile-active">
                                                        <img src="assets/images/profile/profile-small-8.jpg" alt="profile picture">
                                                    </figure>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="single-slide">
                                            <div class="profile-thumb active profile-active">
                                                <a href="javascript:void(0)">
                                                    <figure class="profile-thumb-small profile-active">
                                                        <img src="assets/images/profile/profile-small-2.jpg" alt="profile picture">
                                                    </figure>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="single-slide">
                                            <div class="profile-thumb active profile-active">
                                                <a href="javascript:void(0)">
                                                    <figure class="profile-thumb-small profile-active">
                                                        <img src="assets/images/profile/profile-small-3.jpg" alt="profile picture">
                                                    </figure>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="single-slide">
                                            <div class="profile-thumb active profile-active">
                                                <a href="javascript:void(0)">
                                                    <figure class="profile-thumb-small profile-active">
                                                        <img src="assets/images/profile/profile-small-4.jpg" alt="profile picture">
                                                    </figure>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="single-slide">
                                            <div class="profile-thumb active profile-active">
                                                <a href="javascript:void(0)">
                                                    <figure class="profile-thumb-small profile-active">
                                                        <img src="assets/images/profile/profile-small-5.jpg" alt="profile picture">
                                                    </figure>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="single-slide">
                                            <div class="profile-thumb active profile-active">
                                                <a href="javascript:void(0)">
                                                    <figure class="profile-thumb-small profile-active">
                                                        <img src="assets/images/profile/profile-small-9.jpg" alt="Avatar Notif">
                                                    </figure>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="~/Scripts/modernizr-3.6.0.min.js"></script>
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/popper.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/slick.min.js"></script>
    <script src="~/Scripts/nice-select.min.js"></script>
    <script src="~/Scripts/plyr.min.js"></script>
    <script src="~/Scripts/perfect-scrollbar.min.js"></script>
    <script src="~/Scripts/lightgallery-all.min.js"></script>
    <script src="~/Scripts/imagesloaded.pkgd.min.js"></script>
    <script src="~/Scripts/isotope.pkgd.min.js"></script>
    <script src="~/Scripts/main.js"></script>
    <script src="~/Scripts/toast.js"></script>
    <div class="modal fade" id="textbox" aria-labelledby="textbox">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Share a content</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body custom-scroll">
                    <div class="content-post" style=" border: 1px solid #dddddd;">
                        <select class="form-control" id="categoryId" style="width:200px; height: 30px">
                            @foreach (var item in @ViewBag.Categories)
                            {
                                <option value="@item.Id">@item.Name</option>
                            }
                        </select>
                        <textarea id="content" class="share-field-big custom-scroll" placeholder="Say Something"></textarea>
                        <input hidden id="imgPath" />
                        <div class="upload-btn-wrapper fileSelected">
                            <img id="output" src="~/imgs/blankImg.PNG" style="height: 100%; width: 100%" alt="Choice a image" />
                            <input type="file" style="width: 100%; height:100%" name="myfile" onchange="uploadFile(this)" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" onclick="createNewPost()" class="post-share-btn">post</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="share_post" aria-labelledby="textbox">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Share a post</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body custom-scroll">
                    <div class="custom-scroll">
                        <ul>
                            @foreach (var item in ViewBag.Friends)
                            {
                                <li class="d-flex align-items-center profile-active">
                                    <div class="profile-thumb active">
                                        @if (@item.UserFriend.Avatar != null)
                                        {
                                            <figure class="profile-thumb-small">
                                                <img src="@item.UserFriend.Avatar" alt="Friend Avatar">
                                            </figure>
                                        }
                                        else
                                        {
                                            <figure class="profile-thumb-small">
                                                <img src="~/imgs/avatar_default.png" />
                                            </figure>
                                        }
                                    </div>

                                    <div class="posted-author">
                                        <input value="@item.UserFriend.Id" hidden id="sentToUserId" />
                                        <h6 class="author">@item.UserFriend.FirstName @item.UserFriend.LastName</h6>
                                    </div>
                                    <div class="posted-author">
                                        <button style="height: 34px" onclick="sharePostToFriend()" class="btn-share" type="button"> Share </button>
                                    </div>
                                </li>
                            }
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="modal fade" id="post_detail" aria-labelledby="textbox">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Shared with you</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body custom-scroll">
                    <div class="post-content">
                        <p class="post-desc" id="contentShared">  </p>
                        <div id="formContainerImg" class="post-thumb-gallery post-thumb">
                            <img src="" id="imgShared" class="img-posted" alt="post image" />
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</body>

</html>


<script>
    $.toastDefaults.position = 'top-right';
    $.toastDefaults.dismissible = true;
    $.toastDefaults.stackable = true;
    $.toastDefaults.pauseDelayOnHover = true;
    var postId = 0;
    function openContentPostDetail(newId) {
        var request = $.ajax({
            url: "https://localhost:44399/User/GetNewDetail?newId=" + newId,
            method: "GET",
        });

        request.done(function (response) {
            if (response) {
                $("#post_detail").modal("show");
                $("#contentShared").text(response.Content);
                if (response.Image) {
                    $('#imgShared').attr('src', "/UploadedFiles/"+  response.Image);

                } else {
                    $('#formContainerImg').css('display', 'none');
                }
               
            }
        });

    }
    function openModalShare(id) {
        postId = id;
        $("#share_post").modal("show");
    }
    function sharePostToFriend() {
        let id = $("#sentToUserId").val();
        var request = $.ajax({
            url: "https://localhost:44399/User/SharePostToFriend",
            method: "POST",
            data: { friendId: id, postId: postId }
        });

        request.done(function (response) {
            if (response) {
                setTimeout(() => {
                    $.toast({
                        type: "success",
                        title: "",
                        subtitle: 'Success !',
                        content: "",
                        delay: 3000
                    });
                }, 1000);
                $("#share_post").modal("hide");
            }
        });

        request.fail(function (jqXHR, textStatus) {
            alert("Request failed: " + textStatus);
        });
    }
    function acceptFriend() {
        let id = $("#friendId").val();

        var request = $.ajax({
            url: "https://localhost:44399/User/UserFriendAccept",
            method: "POST",
            data: { friendId: id }
        });

        request.done(function (response) {
            if (response) {
                setTimeout(() => {
                    $.toast({
                        type: "success",
                        title: "",
                        subtitle: 'Success !',
                        content: "",
                        delay: 3000
                    });
                }, 1000);
                $("#share_post").modal("hide");
            }
        });

        request.fail(function (jqXHR, textStatus) {
            alert("Request failed: " + textStatus);
        });
    }
    function removeFriend() {
        let id = $("#friendId").val();

        var request = $.ajax({
            url: "https://localhost:44399/User/UserFriendRemove",
            method: "POST",
            data: { friendId: id }
        });

        request.done(function (response) {

            if (response) {
                setTimeout(() => {
                    $.toast({
                        type: "success",
                        title: "",
                        subtitle: 'Success !',
                        content: "",
                        delay: 3000
                    });
                }, 1000);
                $("#textbox").modal("hide");
            }
        });

        request.fail(function (jqXHR, textStatus) {
            alert("Request failed: " + textStatus);
        });
    }
    function addFriend() {
        let id = $("#userId").val();

        var request = $.ajax({
            url: "https://localhost:44399/User/AddFriend",
            method: "POST",
            data: { toId: id }
        });

        request.done(function (response) {

            if (response) {
                setTimeout(() => {
                    $.toast({
                        type: "success",
                        title: "",
                        subtitle: 'Success !',
                        content: "",
                        delay: 3000
                    });
                }, 1000);
                $("#textbox").modal("hide");
            }
        });

        request.fail(function (jqXHR, textStatus) {
            alert("Request failed: " + textStatus);
        });
    }
    function uploadFile(e) {
        const file = window.URL.createObjectURL(e.files[0]);
        document.getElementById('output').src = file;
        console.log("e.files[0]e.files[0]", e.files[0]);
        var formData = new FormData();
        formData.append(e.files[0].name, e.files[0]);

        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/User/UploadFile');
        xhr.send(formData);
        xhr.onreadystatechange = function () {

            if (xhr.readyState == 4 && xhr.status == 200) {
                const response = JSON.parse(xhr.response);
                debugger
                $("#imgPath").val(response.data);
            }
        }
    }
    function createNewPost() {
        let content = $("textarea#content").val();
        let currentUserId = $("#currentUserId").val();
        let categoryId = $('#categoryId').find(":selected").val();
        let img = $("#imgPath").val();

        var request = $.ajax({
            url: "https://localhost:44399/User/CreatePost",
            method: "POST",
            data: { userId: parseInt(currentUserId), content: content, categoryId: parseInt(categoryId), img: img }
        });

        request.done(function (response) {
            if (response) {
                setTimeout(() => {
                    $.toast({
                        type: "success",
                        title: "",
                        subtitle: 'Success !',
                        content: "",
                        delay: 3000
                    });
                }, 1000);
                $("#textbox").modal("hide");
            }
        });

        request.fail(function (jqXHR, textStatus) {
            alert("Request failed: " + textStatus);
        });
    }
</script>
